Function.prototype.bind=Function.prototype.bind||function(t){var e=Array.prototype.splice.call(arguments,1),n=this,r=function(){var i=e.concat(Array.prototype.splice.call(arguments,0));return this instanceof r?(n.apply(this,i),void 0):n.apply(t,i)};return r.prototype=n.prototype,r},"undefined"==typeof document||"classList"in document.documentElement||function(t){"use strict";if("HTMLElement"in t||"Element"in t){var e="classList",n="prototype",r=(t.HTMLElement||t.Element)[n],i=Object,o=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},a=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},u=function(t,e){if(""===e)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(t,e)},p=function(t){for(var e=o.call(t.className),n=e?e.split(/\s+/):[],r=0,i=n.length;i>r;r++)this.push(n[r]);this._updateClassName=function(){t.className=this.toString()}},h=p[n]=[],c=function(){return new p(this)};if(a[n]=Error[n],h.item=function(t){return this[t]||null},h.contains=function(t){return t+="",-1!==u(this,t)},h.add=function(){var t,e=arguments,n=0,r=e.length,i=!1;do t=e[n]+"",-1===u(this,t)&&(this.push(t),i=!0);while(++n<r);i&&this._updateClassName()},h.remove=function(){var t,e=arguments,n=0,r=e.length,i=!1;do{t=e[n]+"";var o=u(this,t);-1!==o&&(this.splice(o,1),i=!0)}while(++n<r);i&&this._updateClassName()},h.toggle=function(t,e){t+="";var n=this.contains(t),r=n?e!==!0&&"remove":e!==!1&&"add";return r&&this[r](t),!n},h.toString=function(){return this.join(" ")},i.defineProperty){var l={get:c,enumerable:!0,configurable:!0};try{i.defineProperty(r,e,l)}catch(d){-2146823252===d.number&&(l.enumerable=!1,i.defineProperty(r,e,l))}}else i[n].__defineGetter__&&r.__defineGetter__(e,c)}}(self),HTMLElement.prototype.click||(HTMLElement.prototype.click=function(){var t=document.createEvent("MouseEvent");return t.initEvent("click",!0,!0),this.dispatchEvent(t),t}),null==window.console&&(window.console={log:function(){},warn:function(){},info:function(){}}),Element.prototype.fireEvent=function(t,e){var n,r,i;if("string"!=typeof t)throw"No type specified";n=document.createEvent("HTMLEvents"),n.initEvent(t,!0,!0);for(r in e)i=e[r],n[r]=i;return this.dispatchEvent(n),n},Element.prototype.toggleAttribute=function(t,e){var n;return n=!this.hasAttribute(t),void 0!==e&&(n=!!e),n?this.setAttribute(t,"true"):this.removeAttribute(t)},getParent=function(t,e){return t.tagName===e.toUpperCase()?t:t.parentNode?t.parentNode.tagName===e.toUpperCase()?t.parentNode:getParent(t.parentNode,e):null},HTMLElement.prototype.action||(HTMLElement.prototype.action=function(){if("ontouchstart"in window){var t=document.createEvent("UIEvent");return t.initEvent("touchend",!0,!0),this.dispatchEvent(t),t}this.click()}),Function.prototype.once=function(){var t=this,e=!1;return function(){e||(e=!0,t())}},Object.defineProperties(Function.prototype,{property:{value:function(t,e){return e.configurable=!0,e.enumerable=!0,Object.defineProperty(this.prototype,t,e)}},get:{value:function(t,e){var n;return n=Object.getOwnPropertyDescriptor(this.prototype,t),n?n.get=e:n={get:e},this.property(t,n)}},set:{value:function(t,e){var n;return n=Object.getOwnPropertyDescriptor(this.prototype,t),n?n.set=e:n={set:e},this.property(t,n)}}}),Point=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.diff=function(e){return new t(this.x-e.x,this.y-e.y)},t}(),Element.prototype.getPosition=function(){var t;return t=getComputedStyle(this),new Point(parseInt(t.left),parseInt(t.top)+window.scrollY)},Number.prototype.clamp=function(t,e){var n;return t=parseFloat(t),e=parseFloat(e),n=this.valueOf(),n>e?e:t>n?t:n},Number.prototype.clampRange=function(t,e){var n;return t=parseFloat(t),e=parseFloat(e),n=this.valueOf(),n>e?n%e:t>n?e-Math.abs(n%e):n},Element.prototype.index=function(){return Array.prototype.slice.call(this.parentNode.children).indexOf(this)},Object.defineProperty(Node.prototype,"delegateEventListener",{value:function(t,e,n){return this.addEventListener(t,function(t){var r;return r=t.relatedTarget||t.target,r.matchesSelector(e)?n(t):void 0},!0)}}),elm=document.createElement("div"),window.animationSupport=!1;var animationstring="animation",keyframeprefix="",domPrefixes="Webkit Moz O ms Khtml".split(" "),pfx="";if(elm.style.animationName&&(window.animationSupport=!0),window.animationSupport===!1)for(var i=0;i<domPrefixes.length;i++)if(void 0!==elm.style[domPrefixes[i]+"AnimationName"]){pfx=domPrefixes[i],animationstring=pfx+"Animation",keyframeprefix="-"+pfx.toLowerCase()+"-",window.animationSupport=!0;break}this.Element&&function(t){t.matchesSelector=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function(t){for(var e=this,n=(e.parentNode||e.document).querySelectorAll(t),r=-1;n[++r]&&n[r]!=e;);return!!n[r]}}(Element.prototype),function(){for(var t=0,e=["webkit","moz"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),r=Math.max(0,16-(n-t)),i=window.setTimeout(function(){e(n+r)},r);return t=n+r,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),"scrollY"in window||Object.defineProperty(window,"scrollY",{get:function(){return document.documentElement?document.documentElement.scrollTop:void 0}});var UI;UI={verbose:!1,namespace:"ui",version:"0.1.0-RC1",validators:{required:{condition:function(){return this.required},validate:function(){return!!this.value},message:"This field is required!"},maxlength:{condition:function(){return 1/0!==this.maxlength},validate:function(){return this.maxlength>=this.value.toString().length},message:function(){return"Length cannot be bigger then "+this.maxlength+"!"}},pattern:{condition:function(){return this.pattern?"/^.*$/"!==this.pattern.toString():!1},validate:function(){return this.pattern?this.pattern.test(this.value.toString()):!1},message:"Value must match the provided pattern!"},email:{condition:function(){return this.required},validate:function(){return/^[a-z0-9!#$%&'"*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'"*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])$/.test(this.value.toString())},message:"Must be an email address!"}},_wrapPassword:function(t){var e,n,r,i;if(!t._processed){null==t.validators&&(t.validators=UI.Text.prototype.validators),i=UI._geather(UI.iValidable.prototype);for(n in i)e=i[n],"initialize"!==n&&"constructor"!==n&&(r=Object.getOwnPropertyDescriptor(t,n),(!r||r.configurable)&&Object.defineProperty(t,n,e));return UI.iValidable.prototype.initialize.call(t),t._processed=!0}},load:function(t){var e,n,r,i,o,s,a;for(null==t&&(t=document),s=t.querySelectorAll("input[type=password]"),i=0,o=s.length;o>i;i++){if(e=s[i],e._processed)return;this._wrapPassword(e)}a=[];for(n in UI)r=UI[n],r.SELECTOR?a.push(function(){var n,i,o,s;for(o=t.querySelectorAll(r.SELECTOR()),s=[],n=0,i=o.length;i>n;n++)e=o[n],e._processed||(this.load(e),r.wrap(e),s.push("function"==typeof e.onAdded?e.onAdded():void 0));return s}.call(this)):a.push(void 0);return a},initialize:function(){var t=this;return document.addEventListener("DOMNodeInserted",this._insert.bind(this),!0),window.addEventListener("load",function(){return"function"==typeof UI.onBeforeLoad&&UI.onBeforeLoad(),t.load(),setTimeout(function(){return document.body.setAttribute("loaded",!0),"function"==typeof UI.onLoad?UI.onLoad():void 0},1e3)})},promiseElement:function(t,e,n){return null==e&&(e={}),null==n&&(n=[]),function(r){var i,o,s;if("string"!=typeof t)throw"Illegal tagname";if("object"!=typeof e)throw"Illegal attributes";i=document.createElement(t);for(o in e)s=e[o],i.setAttribute(o,s);if(n){if(!(n instanceof Array))throw"Illegal children";UI._build.call(i,n,r)}return i}},_build:function(t,e){var n,r,i,o,s,a,u,p;if(t){for(p=[],a=0,u=t.length;u>a;a++)s=t[a],"string"==typeof s?(i=document.createTextNode(s),p.push(this.appendChild(i))):s instanceof Function?p.push(this.appendChild(s(e))):p.push(function(){var t;t=[];for(r in s)o=s[r],n=o(e),this.appendChild(n),t.push(e[r]=n);return t}.call(this));return p}},_insert:function(t){var e,n,r;if(t.target.tagName&&(n=t.target.tagName,"INPUT"===n&&"password"===t.target.getAttribute("type")&&this._wrapPassword(t.target),n.match(/^UI-/)&&(e=n.split("-").pop().toLowerCase().replace(/^\w|\s\w/g,function(t){return t.toUpperCase()}),this[e])))return t.target._processed?"function"==typeof(r=t.target).onAdded?r.onAdded():void 0:this[e].wrap(t.target)},_geather:function(t){var e,n,r,i,o,s,a,u,p,h,c,l,d,_,f;for(a={},l=Object.keys(t),u=0,h=l.length;h>u;u++)if(i=l[u],"implements"===i)for(d=t[i],p=0,c=d.length;c>p;p++){o=d[p],_=this._geather(o.prototype);for(r in _)e=_[r],null==a[r]&&(a[r]=e)}else a[i]=Object.getOwnPropertyDescriptor(t,i);if((s=Object.getPrototypeOf(t))!==Object.prototype){f=this._geather(s);for(i in f)n=f[i],null==a[i]&&(a[i]=n)}return a}},window.UI=UI,UI.Events="ontouchstart"in window?{action:"touchend",dragStart:"touchstart",dragMove:"touchmove",dragEnd:"touchend",enter:"touchstart",leave:"touchend",input:"input",beforeInput:"keydown",blur:"blur",keypress:"keypress",keyup:"keyup"}:{action:"click",dragStart:"mousedown",dragMove:"mousemove",dragEnd:"mouseup",enter:"mouseover",leave:"mouseout",input:"input",beforeInput:"keydown",blur:"blur",keypress:"keypress",keyup:"keyup"},UI.Abstract=function(){function t(){}return t.get("disabled",function(){return this.hasAttribute("disabled")}),t.set("disabled",function(t){return this.toggleAttribute("disabled",!!t)}),t.SELECTOR=function(){return UI.namespace+"-"+this.TAGNAME},t.wrap=function(t){var e,n,r,i,o,s,a,u,p;s=UI._geather(this.prototype);for(r in s)n=s[r],"initialize"!==r&&"constructor"!==r&&Object.defineProperty(t,r,n);if(this.TABABLE&&t.setAttribute("tabindex",0),t._processed=!0,null!=(a=this.prototype.initialize)&&a.call(t),this.prototype["implements"]){for(u=this.prototype["implements"],p=[],i=0,o=u.length;o>i;i++)e=u[i],p.push(e.prototype.initialize.call(t));return p}},t.create=function(t){var e,n,r;if(e=document.createElement(this.SELECTOR()),this.MARKUP&&UI._build.call(e,this.MARKUP,e),t){if("object"!=typeof t)throw"Illegal attributes";for(n in t)r=t[n],e.setAttribute(n,r)}return this.wrap(e),e},t.promise=function(t,e){var n=this;return null==t&&(t={}),function(r){var i;return i=n.create(t),UI._build.call(i,e,r),i}},t.prototype.toString=function(){return"<"+this.tagName.toLowerCase()+">"},t}();var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Button=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="button",e.TABABLE=!0,e.get("label",function(){return this.textContent}),e.set("label",function(t){return this.textContent=t}),e.get("type",function(){return this.getAttribute("type")||"default"}),e.set("type",function(t){return t?this.setAttribute("type",t):this.removeAttribute("type")}),e.prototype._cancel=function(t){return this.disabled?(t.stopImmediatePropagation(),t.stopPropagation()):void 0},e.prototype._keydown=function(t){return 13===t.keyCode?(t.preventDefault(),this.fireEvent(UI.Events.action)):void 0},e.prototype.initialize=function(){return this.addEventListener(UI.Events.action,this._cancel),this.addEventListener("keydown",this._keydown)},e}(UI.Abstract),UI.iValidable=function(){function t(){}return t.get("required",function(){return this.hasAttribute("required")}),t.get("maxlength",function(){return parseInt(this.getAttribute("maxlength"))||1/0}),t.get("valid",function(){return this.hasAttribute("valid")}),t.get("invalid",function(){return this.hasAttribute("invalid")}),t.get("pattern",function(){var t;t=this.getAttribute("pattern")||".*";try{return new RegExp("^"+t+"$")}catch(e){return/^.*$/}}),t.prototype.validate=function(){var t,e,n,r,i,o,s,a;for(this.toggleAttribute("invalid",!1),this.toggleAttribute("valid",!1),t=!1,s=this.validators,n=0,i=s.length;i>n;n++)if(e=s[n],e.condition.call(this)){t=!0;break}if(!t)return void 0;for(a=this.validators,r=0,o=a.length;o>r;r++)if(e=a[r],e.condition.call(this)&&!e.validate.call(this))return this.toggleAttribute("invalid",!0),this.fireEvent("validate",{valid:!1}),!1;return this.toggleAttribute("valid",!0),this.fireEvent("validate",{valid:!0}),!0},t.prototype.initialize=function(){return this.addEventListener("keyup",this.validate),this.addEventListener("change",this.validate),this.validate()},t}();var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.iCheckable=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype["implements"]=[UI.iValidable],e.prototype.validators=[UI.validators.required],e.TABABLE=!0,e.get("value",function(){return this.hasAttribute("checked")}),e.set("value",function(t){return this.checked=t}),e.get("checked",function(){return this.hasAttribute("checked")}),e.set("checked",function(t){return this.checked!==t?(this.toggleAttribute("checked",!!t),this.fireEvent("change")):void 0}),e.prototype._toggle=function(){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:this.toggle()},e.prototype.toggle=function(){return this.checked=!this.checked},e.prototype.initialize=function(){return this.addEventListener(UI.Events.action,this._toggle),this.addEventListener("keydown",function(t){return 13===t.keyCode?this._toggle():void 0})},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Checkbox=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="checkbox",e}(UI.iCheckable);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.iInput=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype["implements"]=[UI.iValidable],e.get("value",function(){return this.textContent}),e.set("value",function(t){var e;return e=this.textContent,this.textContent=t,e!==t?this.fireEvent("change"):void 0}),e.get("placeholder",function(){return this.getAttribute("placeholder")}),e.set("placeholder",function(t){return this.setAttribute("placeholder",t)}),e.get("disabled",function(){return this.hasAttribute("disabled")}),e.set("disabled",function(t){return this.toggleAttribute("disabled",!!t),this.toggleAttribute("contenteditable",!t)}),e.prototype.cleanup=function(){return this.normalize(),1===this.childNodes.length?"BR"===this.childNodes[0].tagName?this.removeChild(this.childNodes[0]):3===this.childNodes[0].nodeType?this.childNodes[0].textContent=this.childNodes[0].textContent.trim():void 0:void 0},e.prototype.initialize=function(){return this.setAttribute("contenteditable",!0),this.addEventListener(UI.Events.blur,this.cleanup)},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Text=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.validators=[UI.validators.required,UI.validators.maxlength,UI.validators.pattern],e.TAGNAME="text",e.prototype._keydown=function(t){return 13===t.keyCode?t.preventDefault():void 0},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.addEventListener(UI.Events.beforeInput,this._keydown)},e}(UI.iInput);var Color;Color=function(){function t(t){var e,n;if(null==t&&(t="FFFFFF"),t.trim()||(t="FFFFFF"),"transparent"===t&&(t="rgba(0,0,0,0)"),t=t.trim().toString(),t=t.replace(/\s/g,""),n=t.match(/^#?([0-9a-f]{3}|[0-9a-f]{6})$/i))e=t.match(/^#/)?t.slice(1):t,3===e.length&&(e=e.replace(/([0-9a-f])/gi,"$1$1")),this.type="hex",this._hex=e,this._alpha=100,this._update("hex");else if(null!=(n=t.match(/^hsla?\((-?\d+),\s*(-?\d{1,3})%,\s*(-?\d{1,3})%(,\s*([01]?\.?\d*))?\)$/)))this.type="hsl",this._hue=parseInt(n[1]).clampRange(0,360),this._saturation=parseInt(n[2]).clamp(0,100),this._lightness=parseInt(n[3]).clamp(0,100),this._alpha=parseInt(100*parseFloat(n[5]))||100,this._alpha=this._alpha.clamp(0,100),this.type+=n[5]?"a":"",this._update("hsl");else{if(null==(n=t.match(/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([01]?\.?\d*))?\)$/)))throw"Wrong color format!";this.type="rgb",this._red=parseInt(n[1]).clamp(0,255),this._green=parseInt(n[2]).clamp(0,255),this._blue=parseInt(n[3]).clamp(0,255),this._alpha=parseInt(100*parseFloat(n[5]))||100,this._alpha=this._alpha.clamp(0,100),this.type+=n[5]?"a":"",this._update("rgb")}}return t.get("red",function(){return this._red}),t.set("red",function(t){return this._red=parseInt(t).clamp(0,255),this._update("rgb")}),t.get("green",function(){return this._green}),t.set("green",function(t){return this._green=parseInt(t).clamp(0,255),this._update("rgb")}),t.get("blue",function(){return this._blue}),t.set("blue",function(t){return this._blue=parseInt(t).clamp(0,255),this._update("rgb")}),t.get("lightness",function(){return this._lightness}),t.set("lightness",function(t){return this._lightness=parseInt(t).clamp(0,100),this._update("hsl")}),t.get("saturation",function(){return this._saturation}),t.set("saturation",function(t){return this._saturation=parseInt(t).clamp(0,100),this._update("hsl")}),t.get("rgb",function(){return this.toString("rgb")}),t.get("rgba",function(){return this.toString("rgba")}),t.get("hsl",function(){return this.toString("hsl")}),t.get("hsla",function(){return this.toString("hsla")}),t.get("hex",function(){return"#"+this._hex}),t.set("hex",function(t){return this._hex=t,this._update("hex")}),t.get("hue",function(){return this._hue}),t.set("hue",function(t){return this._hue=parseInt(t).clampRange(0,360),this._update("hsl")}),t.get("alpha",function(){return this._alpha}),t.set("alpha",function(t){return this._alpha=parseInt(t).clamp(0,100)}),t.prototype.invert=function(){return this._red=255-this._red,this._green=255-this._green,this._blue=255-this._blue,this._update("rgb"),this},t.prototype.mix=function(e,n){var r,i,o,s,a;for(null==n&&(n=50),e instanceof t||(e=new t(e)),r=new t,a=["red","green","blue"],o=0,s=a.length;s>o;o++)i=a[o],r[i]=Math.round(e[i]/100*(100-n)+this[i]/100*n).clamp(0,255);return r},t.prototype._hsl2rgb=function(){var t,e,n,r,i,o,s,a,u;for(t=this._hue/360,i=this._saturation/100,n=this._lightness/100,0===i&&(u=Math.round(255*n),this._red=u,this._green=u,this._blue=u),s=.5>n?n*(1+i):n+i-n*i,o=2*n-s,r=[0,0,0],e=0;3>e;)a=t+1/3*-(e-1),0>a&&a++,a>1&&a--,u=1>6*a?o+6*(s-o)*a:1>2*a?s:2>3*a?o+6*(s-o)*(2/3-a):o,r[e]=255*u,e++;return this._red=Math.round(r[0]),this._green=Math.round(r[1]),this._blue=Math.round(r[2])},t.prototype._hex2rgb=function(){var t;return t=parseInt(this._hex,16),this._red=t>>16,this._green=255&t>>8,this._blue=255&t},t.prototype._rgb2hex=function(){var t,e;return t=this._red<<16|65535&this._green<<8|this._blue,e=t.toString(16),e="000000".substr(0,6-e.length)+e,this._hex=e.toUpperCase()},t.prototype._rgb2hsl=function(){var t,e,n,r,i,o,s,a,u;return a=this._red/255,n=this._green/255,t=this._blue/255,s=Math.min(a,n,t),o=Math.max(a,n,t),e=o-s,o===s?r=0:a===o?r=(n-t)/e:n===o?r=2+(t-a)/e:t===o&&(r=4+(a-n)/e),r=Math.min(60*r,360),0>r&&(r+=360),i=(s+o)/2,u=o===s?0:.5>=i?e/(o+s):e/(2-o-s),this._hue=r,this._saturation=100*u,this._lightness=100*i},t.prototype._update=function(t){switch(t){case"rgb":return this._rgb2hsl(),this._rgb2hex();case"hsl":return this._hsl2rgb(),this._rgb2hex();case"hex":return this._hex2rgb(),this._rgb2hsl()}},t.prototype.toString=function(t){switch(null==t&&(t="hex"),t){case"rgb":return"rgb("+this._red+", "+this._green+", "+this._blue+")";case"rgba":return"rgba("+this._red+", "+this._green+", "+this._blue+", "+this.alpha/100+")";case"hsl":return"hsl("+this._hue+", "+Math.round(this._saturation)+"%, "+Math.round(this._lightness)+"%)";case"hsla":return"hsla("+this._hue+", "+Math.round(this._saturation)+"%, "+Math.round(this._lightness)+"%, "+this.alpha/100+")";case"hex":return this.hex}},t}(),window.ColorType=Color;var color,picker,_ref,__bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};picker=function(){function t(){this.dragCircle=__bind(this.dragCircle,this),this.dragTriangle=__bind(this.dragTriangle,this);var t,e,n,r,i=this;for(this.el=document.createElement("picker"),document.body.appendChild(this.el),document.addEventListener(UI.Events.action,function(t){return picker=getParent(t.target,"picker"),picker?t.preventDefault():void 0}),this.circleCanvas=document.createElement("canvas"),this.triangle=document.createElement("triangle"),this.triangle.appendChild(document.createElement("gradient")),this.triangle.style.background="red",this.circleCanvas.width=160,this.circleCanvas.height=160,this.drawHSLACone(160),r=["point","point2"],e=0,n=r.length;n>e;e++)t=r[e],this[t]=document.createElement("point");this.color=new Color("#ff0000"),this.endColor=new Color("#ff0000"),this.triangle.style.width="82px",this.triangle.style.height="82px",this.el.appendChild(this.triangle),this.el.appendChild(this.circleCanvas),this.triangle.appendChild(this.point),this.el.appendChild(this.point2),this.drag=new Drag(this.el),this.el.addEventListener("dragmove",function(t){return t.stopPropagation(),i.dragCircle(t),i.dragTriangle(t)}),this.el.addEventListener("dragstart",function(t){return t.stopPropagation(),i.dragCircle(t),i.dragTriangle(t)})}return t.prototype.fromColor=function(t,e){var n,r;null==e&&(e=!0);try{if(n=new Color(t),r=69,this.angleRad=-n.hue*(Math.PI/180),this.point2.style.top=r*Math.sin(this.angleRad)+85+"px",this.point2.style.left=r*Math.cos(this.angleRad)+85+"px",this.point.style.left=82*(n.saturation/100)-6+"px",this.point.style.top=82*Math.min((100-n.lightness)/100,100-n.saturation/50)-6+"px",this.color.hue=n.hue,this.endColor=n,this.triangle.style.background=this.color.hex,e)return this.setBoundValue()}catch(i){}},t.prototype.dragTriangle=function(t){var e,n,r;if(!t._stop)return r=this.triangle.getBoundingClientRect(this.triangle),n=new Point(this.drag.position.x,this.drag.position.y),e=n.diff(new Point(r.left,r.top+window.scrollY)),this.point.style.top=(e.y-6).clamp(-6,76)+"px",this.point.style.left=(e.x-6).clamp(-6,76)+"px",this.endColor.lightness=Math.min(100-Math.round(100*(e.y/82)),100-Math.round(50*(e.x/82))),this.endColor.saturation=Math.round(100*(e.x/82)),this.setBoundValue()},t.prototype.setBoundValue=function(){var t;return null!=(t=this.bound)?t.value=this.endColor.hex:void 0},t.prototype.bind=function(t){return this.bound=t},t.prototype.dragCircle=function(t){var e,n,r,i,o,s,a;return s=this.circleCanvas.getBoundingClientRect(),n=new Point(this.drag.position.x,this.drag.position.y),r=n.diff(new Point(s.left,s.top+window.scrollY)),a=r.y-80,e=r.x-80,i=Math.sqrt(Math.pow(a,2)+Math.pow(e,2)),o=69,i>60&&80>i?(t._stop=!0,this.angleRad=Math.atan2(a,e),this.angle=this.angleRad*(180/Math.PI),this.point2.style.top=o*Math.sin(this.angleRad)+85+"px",this.point2.style.left=o*Math.cos(this.angleRad)+85+"px",this.endColor.hue=this.color.hue=360-this.angle,this.triangle.style.background=this.color.hex,this.setBoundValue()):void 0},t.prototype.drawHSLACone=function(t){var e,n,r,i,o,s,a,u,p;for(i=this.circleCanvas.getContext("2d"),i.translate(t/2,t/2),s=-t/2,e=t/50,n=1/e*Math.PI/180,o=0,p=[],o=a=0,u=360*e-1;u>=0?u>=a:a>=u;o=u>=0?++a:--a)r=new Color("#ff0000"),r.hue=360-o/e,i.strokeStyle=r.hex,i.beginPath(),i.moveTo(t/2-20,0),i.lineTo(t/2,0),i.stroke(),p.push(i.rotate(n));return p},t.prototype.hide=function(){return"block"===getComputedStyle(this.el).display?this.el.style.display="none":void 0},t.prototype.show=function(t){var e;return this.bind(t),this.startColor=t.value,e=t.getBoundingClientRect(),e={top:e.top+window.scrollY,left:e.left,height:e.height,width:e.width},this.fromColor(t.value),window.innerWidth<180+e.left?(this.el.classList.remove("left"),this.el.classList.add("right"),this.el.style.left=e.left-180+e.width+"px"):(this.el.style.left=e.left+"px",this.el.classList.remove("right"),this.el.classList.add("left")),window.innerHeight<180+e.top?(this.el.style.top=e.top-e.height-163+"px",this.el.classList.remove("bottom"),this.el.classList.add("top")):(this.el.style.top=e.top+e.height+"px",this.el.classList.remove("top"),this.el.classList.add("bottom")),this.el.style.display="block"},t}(),color=Color,UI.Color=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="color",e.get("value",function(){return new color(getComputedStyle(this).backgroundColor).hex}),e.set("value",function(t){var e,n;n=this.value,document.querySelector(":focus")===this&&ColorPicker.fromColor(t,!1);try{return e=new color(t),this.style.backgroundColor=e.hex,this.style.color=e.lightness<50?"#fff":"#000",this.value!==n&&this.fireEvent("change"),this.textContent=t.replace("#","")}catch(r){}}),e.prototype._focus=function(t){return t.stopPropagation(),this.disabled?void 0:ColorPicker.show(this)},e.prototype._keypress=function(t){return-1===[39,37,8,46,9].indexOf(t.keyCode)?/^[0-9A-Za-z]$/.test(String.fromCharCode(t.charCode))?this.value=this.textContent:t.preventDefault():void 0},e.prototype._keyup=function(){return this.value=this.textContent},e.prototype._blur=function(){return ColorPicker.hide(),this.value=this.textContent},e.prototype.initialize=function(){return null==window.ColorPicker&&(window.ColorPicker=new picker),this.setAttribute("contenteditable",!0),this.setAttribute("spellcheck",!1),this.addEventListener("focus",this._focus),this.addEventListener(UI.Events.keypress,this._keypress),this.addEventListener(UI.Events.keyup,this._keyup),this.addEventListener(UI.Events.blur,this._blur),this.value=this.getAttribute("value")||"#fff"},e}(UI.Text);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Context=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="context",e.prototype._open=function(t){var e,n;if(!this.disabled)return t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),e=t.pageX,n=t.pageY,this.open(e,n)},e.prototype._close=function(t){return 2===t.button||this.disabled?void 0:this.close()},e.prototype.open=function(t,e){var n;return t&&e||(n=this.parentNode.getBoundingClientRect(),t=n.left,e=n.top),this.style.left=t+"px",this.style.top=e+"px",this.setAttribute("open",!0)},e.prototype.close=function(){return this.removeAttribute("open")},e.prototype.onAdded=function(){return null==this.$close&&(this.$close=this._close.bind(this)),null==this.$open&&(this.$open=this._open.bind(this)),this._parent&&this._parent.removeEventListener("contextmenu",this.$close),this._parent=this.parentNode,this._parent.addEventListener("contextmenu",this._open.bind(this))},e.prototype.initialize=function(){return document.addEventListener(UI.Events.action,this._close.bind(this)),document.addEventListener("contextmenu",this._close.bind(this)),document.body.appendChild(this)},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.iOpenable=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.get("isOpen",function(){return this.hasAttribute("open")}),e.get("direction",function(){var t;return t=this.getAttribute("direction"),-1===this._directions.indexOf(t)?"bottom":t}),e.set("direction",function(t){return-1===this._directions.indexOf(t)&&(t="bottom"),"bottom"===t?this.removeAttribute("direction"):this.setAttribute("direction",t)}),e.prototype.onAdded=function(){return"static"===getComputedStyle(this.parentNode).position?this.parentNode.style.position="relative":void 0},e.prototype.open=function(){return this.setAttribute("open",!0)},e.prototype.close=function(){return this.removeAttribute("open")},e.prototype.toggle=function(){return this.toggleAttribute("open")},e.prototype.initialize=function(t){this._directions=null!=t?t:[]},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Dropdown=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="dropdown",e.prototype._toggle=function(){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:this.toggle()},e.prototype._open=function(){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:this.open()},e.prototype._close=function(t){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:getParent(t.target,UI.Dropdown.SELECTOR())!==this&&getParent(t.target,this.parentNode.tagName)!==this.parentNode?this.close():void 0},e.prototype.onAdded=function(){return e.__super__.onAdded.apply(this,arguments),null==this.$open&&(this.$open=this._open.bind(this)),null==this.$toggle&&(this.$toggle=this._toggle.bind(this)),this._parent&&(this._parent.removeEventListener(UI.Events.action,this.$open),this._parent.removeEventListener(UI.Events.action,this.$toggle)),this._parent=this.parentNode,this._parent.tagName.toLowerCase()===UI.Select.SELECTOR()?this._parent.addEventListener(UI.Events.action,this.$open):this._parent.addEventListener(UI.Events.action,this.$toggle)},e.prototype.initialize=function(){return e.__super__.initialize.call(this,["top","bottom","left","right"]),document.addEventListener(UI.Events.action,this._close.bind(this))},e}(UI.iOpenable);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Email=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.validators=UI.Text.prototype.validators.concat(UI.validators.email),e.TAGNAME="email",e}(UI.Text);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Form=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="form",e.get("data",function(){var t,e,n,r,i;for(t={},i=this.querySelectorAll("[name]"),n=0,r=i.length;r>n;n++)e=i[n],e.value&&(t[e.getAttribute("name")]=e.value);return t}),e.get("action",function(){return this.getAttribute("action")
}),e.set("action",function(t){return this.setAttribute("action",t)}),e.get("method",function(){var t;return this.hasAttribute("method")?(t=this.getAttribute("method").toLowerCase(),-1===["get","post","delete","patch","put"].indexOf(t)?"get":t):"get"}),e.set("method",function(t){return-1===["get","post","delete","patch","put"].indexOf(t.toLowerCase())&&(t="get"),this.setAttribute("method",t.toLowerCase())}),e.get("valid",function(){var t,e,n,r;for(r=this.querySelectorAll("*"),e=0,n=r.length;n>e;e++)if(t=r[e],t.hasAttribute("invalid"))return!1;return!0}),e.get("invalid",function(){return!this.valid}),e.prototype.validate=function(){var t,e,n,r;for(r=this.querySelectorAll("[name]"),e=0,n=r.length;n>e;e++)t=r[e],"function"==typeof t.validate&&t.validate();return this.valid},e.prototype.submit=function(){var t,e,n=this;return this.invalid?!1:(t=this.fireEvent("submit"),t.defaultPrevented?void 0:(e=new XMLHttpRequest,e.onreadystatechange=function(){var t,r,i;return 4===e.readyState?(r={},e.getAllResponseHeaders().split("\n").map(function(t){var e,n,i;return i=t.split(": "),e=i[0],n=i[1],e&&n?r[e]=n:void 0}),t=e.response,i=e.status,n.fireEvent("complete",{response:{headers:r,body:t,status:i}})):void 0},e.open(this.method.toUpperCase(),this.action),e.send(this.data)))},e}(UI.Abstract);var _ref,_ref1,_ref2,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Cell=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="cell",e}(UI.Abstract),UI.Placeholder=function(t){function e(){return _ref1=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="placeholder",e}(UI.Abstract),UI.Grid=function(t){function e(){return _ref2=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="grid",e.get("columns",function(){return parseInt(this.getAttribute("columns"))}),e.set("columns",function(t){return this.setAttribute("columns",parseInt(t)),this._updating=!0,this._update()}),e.prototype._update=function(){var t,e,n,r,i,o,s,a;for(a=Array.prototype.slice.call(this.querySelectorAll(UI.Placeholder.SELECTOR())),i=0,s=a.length;s>i;i++)n=a[i],n.parentNode.removeChild(n);if(this.normalize(),t=this.querySelectorAll(UI.Cell.SELECTOR()).length,e=this.columns-t%this.columns,e!==this.columns){for(r=o=1;e>=1?e>=o:o>=e;r=e>=1?++o:--o)this.appendChild(document.createTextNode(" ")),this.appendChild(document.createElement(UI.Placeholder.SELECTOR()));this.normalize()}return this._updating=!1},e.prototype.initialize=function(){var t,e,n,r,i,o=this;for(this._update(),this.addEventListener("DOMNodeRemoved",function(){return o._updating?void 0:(o._updating=!0,setTimeout(o._update.bind(o)))}),this.addEventListener("DOMNodeInserted",function(){return o._updating?void 0:(o._updating=!0,o._update())}),r=this.querySelectorAll("ui-cell"),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.insertBefore(document.createTextNode(" "),t));return i},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Label=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="label",e.prototype._redirect=function(){var t;return(t=document.querySelector("[name='"+this.getAttribute("for")+"']"))?(t.focus(),t.action()):void 0},e.prototype.initialize=function(){return this.addEventListener(UI.Events.action,this._redirect)},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Modal=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="modal",e.get("isOpen",function(){return this.hasAttribute("open")}),e.prototype.close=function(){return this.disabled?void 0:this.removeAttribute("open")},e.prototype.open=function(){return this.disabled?void 0:this.setAttribute("open",!0)},e.prototype.toggle=function(){return this.disabled?void 0:this.toggleAttribute("open")},e.prototype.initialize=function(){return document.body.appendChild(this)},e}(UI.Abstract);var _ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Message=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="message",e.MARKUP=[{content:UI.promiseElement("div")}],e}(UI.Abstract),UI.Notification=function(t){function e(){return _ref1=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="notification",e.prototype.defaultTimeout=5e3,e.prototype.push=function(t,e){var n,r,i,o,s,a,u=this;if(n=UI.Message.create({type:e}),n.content.innerHTML=t,this.appendChild(n),r=function(){return u.removeChild(n)}.once(),window.animationSupport){for(s=["animationend","webkitAnimationEnd","oanimationend","MSAnimationEnd"],a=[],i=0,o=s.length;o>i;i++)e=s[i],a.push(n.addEventListener(e,r));return a}return setTimeout(r,this.defaultTimeout)},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Number=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.validators=[UI.validators.required],e.TAGNAME="number",e.get("value",function(){var t;return t=parseFloat(this.textContent),isNaN(t)?"":t}),e.set("value",function(t){return t=parseFloat(t),isNaN(t)&&(t=""),this.textContent=t}),e.prototype._keypress=function(t){return-1===[39,37,8,46,9].indexOf(t.keyCode)?/^[0-9.]$/.test(String.fromCharCode(t.charCode))?void 0:t.preventDefault():void 0},e.prototype._change=function(){return this.fireEvent("change")},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.addEventListener("keypress",this._keypress),this.addEventListener("keyup",this._change),this.addEventListener("blur",this._change)},e}(UI.Text);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Option=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="option",e.get("selected",function(){return this.hasAttribute("selected")}),e.set("selected",function(t){return this.toggleAttribute("selected",!!t)}),e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Page=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="page",e.get("active",function(){return!!this.getAttribute("active")}),e.set("active",function(t){return this.toggleAttribute("active",!!t)}),e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Pager=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="pager",e.set("activePage",function(t){return this.change(t)}),e.get("activePage",function(){var t,e,n,r;for(r=this.children,e=0,n=r.length;n>e;e++)if(t=r[e],t.matchesSelector(UI.Page.SELECTOR()+"[active]"))return t}),e.prototype.next=function(){return this.change(this.activePage.nextElementSibling)},e.prototype.prev=function(){return this.change(this.activePage.previousElementSibling)},e.prototype.change=function(t){var e,n;return t instanceof HTMLElement?t.parentNode===this&&(e=t):e=this.querySelector(UI.Page.SELECTOR()+("[name='"+t+"']")),e&&this.activePage!==e?(null!=(n=this.activePage)&&(n.active=!1),e.active=!0,this.fireEvent("change")):void 0},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Popover=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="popover",e.prototype._toggle=function(){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:this.toggle()},e.prototype._close=function(t){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:getParent(t.target,this.parentNode.tagName)!==this.parentNode?this.close():void 0},e.prototype.onAdded=function(){var t=this;return e.__super__.onAdded.apply(this,arguments),this.parentNode.addEventListener(UI.Events.action,this._toggle.bind(this)),this.parentNode.addEventListener("keydown",function(e){return e.ctrlKey?t._toggle():void 0})},e.prototype.initialize=function(){return e.__super__.initialize.call(this,["top","bottom","left","right"]),document.addEventListener(UI.Events.action,this._close.bind(this))},e}(UI.iOpenable);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Radio=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="radio",e.get("checked",function(){return this.hasAttribute("checked")}),e.set("checked",function(t){var e,n,r,i,o,s;if(t=!!t,this.checked!==t){if(t)for(s=document.querySelectorAll(UI.Radio.SELECTOR()+("[name='"+this.getAttribute("name")+"']")),i=0,o=s.length;o>i;i++)r=s[i],r!==this&&(e=r.checked,r.removeAttribute("checked"),e&&r.fireEvent("change"));else{if(n=document.querySelector(UI.Radio.SELECTOR()+("[name='"+this.getAttribute("name")+"']:not([checked])")),!n)return;e=!n.checked,n.setAttribute("checked",!0),e&&n.fireEvent("change")}return this.toggleAttribute("checked",t),this.fireEvent("change")}}),e.prototype._toggle=function(){return this.checked?void 0:e.__super__._toggle.apply(this,arguments)},e}(UI.iCheckable);var Drag,__bind=function(t,e){return function(){return t.apply(e,arguments)}};Drag=function(){function t(t){this.base=null!=t?t:document.body,this.up=__bind(this.up,this),this.pos=__bind(this.pos,this),this.move=__bind(this.move,this),this.start=__bind(this.start,this),this.reset(),this.base.addEventListener(UI.Events.dragStart,this.start)}return t.get("diff",function(){return this.position instanceof Point||this.startPosition instanceof Point?this.startPosition.diff(this.position):null}),t.prototype.destroy=function(){return this.base.removeEventListener(UI.Events.dragStart,this.start)},t.prototype.reset=function(){return this.position=this.startPosition=null,this.mouseIsDown=!1},t.prototype.getPosition=function(t){return t.touches?new Point(t.touches[0].pageX,t.touches[0].pageY):new Point(t.pageX,t.pageY)},t.prototype.start=function(t){var e;if(!this.base.hasAttribute("disabled")&&(this.position=this.startPosition=this.getPosition(t),e=this.base.fireEvent("dragstart",{_target:t.target,shiftKey:t.shiftKey}),!e.stopped))return this.mouseIsDown=!0,t.preventDefault(),document.addEventListener(UI.Events.dragMove,this.pos),document.addEventListener(UI.Events.dragEnd,this.up),requestAnimationFrame(this.move)},t.prototype.move=function(){return this.mouseIsDown&&requestAnimationFrame(this.move),this.position?this.base.fireEvent("dragmove"):void 0},t.prototype.pos=function(t){return t.preventDefault(),this.position=this.getPosition(t)},t.prototype.up=function(t){return t.preventDefault(),this.reset(),document.removeEventListener(UI.Events.dragMove,this.pos),document.removeEventListener(UI.Events.dragEnd,this.up),this.base.fireEvent("dragend")},t}();var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Range=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="range",e.TABABLE=!0,e.get("range",function(){return Math.abs(this.min-this.max)}),e.get("_percent",function(){return Math.abs(this.min-this.value)/this.range}),e.get("min",function(){return parseFloat(this.getAttribute("min"))}),e.set("min",function(t){var e;return e=this._percent,this.setAttribute("min",parseFloat(t)),this._setValue(e)}),e.get("max",function(){return parseFloat(this.getAttribute("max"))}),e.set("max",function(t){var e;return e=this._percent,this.setAttribute("max",parseFloat(t)),this._setValue(e)}),e.get("value",function(){var t;return t=parseFloat(this.knob.style.left),this.range*(t/100)+this.min}),e.set("value",function(t){var e;return t=parseFloat(t).clamp(this.min,this.max),this.value!==t?(e=100*(Math.abs(this.min-t)/this.range),this.knob.style.left=e+"%",this._setValue(e/100,!1),this.fireEvent("change"),this.value):void 0}),e.prototype._setValue=function(t,e){return null==e&&(e=!0),e?this.value=this.range*t+this.min:void 0},e.prototype._start=function(t){var e,n,r;return this.focus(),t.stopPropagation(),r=this.getBoundingClientRect(),e=this.knob.getBoundingClientRect(),this.startPosition=this.drag.startPosition.diff(new Point(r.left,r.top)),n=this.startPosition.x/this.offsetWidth,this._setValue(n)},e.prototype._move=function(t){var e,n,r;return t.stopPropagation(),n=this.startPosition.diff(this.drag.diff),e=n.x.clamp(0,this.offsetWidth),r=e/this.offsetWidth,this._setValue(r)},e.prototype._keydown=function(t){var e;switch(e=this.range*(t.shiftKey?.1:.01),t.keyCode){case 37:case 38:return this.value-=e;case 39:case 40:return this.value+=e}},e.prototype.initialize=function(){var t,e;return 0===this.children.length&&(t=document.createElement("div"),t.appendChild(document.createElement("div")),this.appendChild(t)),this.knob=this.children[0],this.knob.style.left=0,this.min||this.setAttribute("min",0),this.max||this.setAttribute("max",100),isNaN(e=parseFloat(this.getAttribute("value")))||(e=e.clamp(this.min,this.max),this._setValue((e-this.min)/this.range)),this.drag=new Drag(this),this.addEventListener("dragstart",this._start),this.addEventListener("dragmove",this._move),this.addEventListener("keydown",this._keydown)},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Select=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype["implements"]=[UI.iValidable],e.prototype.validators=[UI.validators.required],e.TAGNAME="select",e.TABABLE=!0,e.MARKUP=[UI.Label.promise(),UI.Dropdown.promise()],e.get("dropdown",function(){return this.querySelector(UI.Dropdown.SELECTOR())}),e.get("label",function(){return this.querySelector(UI.Label.SELECTOR())}),e.set("value",function(t){return this.select(t)}),e.get("value",function(){return this.selectedOption?this.selectedOption.getAttribute("value"):null}),e.get("selectedOption",function(){return this.querySelector(UI.Option.SELECTOR()+"[selected]")}),e.set("selectedOption",function(t){return this.select(t)}),e.prototype._nodeRemoved=function(t){return 1===t.target.nodeType&&(t.target.matchesSelector(UI.Option.SELECTOR())||t.target.hasAttribute("selected"))?(t.target.setAttribute("disposed",!0),this.selectDefault()):void 0},e.prototype._nodeAdded=function(t){return 1===t.target.nodeType?this.selectDefault():void 0},e.prototype._select=function(t){return!this.disabled&&t.target.matchesSelector(UI.Option.SELECTOR())?(t.stopImmediatePropagation(),t.stopPropagation(),this.select(t.target),this.blur()):void 0},e.prototype._blur=function(){var t;if(!this.disabled)return null!=(t=this.dropdown)?t.close():void 0},e.prototype._focus=function(){var t;if(!this.disabled)return null!=(t=this.dropdown)?t.open():void 0},e.prototype._keydown=function(t){var e,n;if(-1!==[37,38,39,40].indexOf(t.keyCode))switch(n=this.selectedOption.parentNode,e=this.selectedOption.index(),t.keyCode){case 37:case 38:return t.preventDefault(),this.select(n.children[(--e).clamp(0,n.children.length-1)]);case 39:case 40:return t.preventDefault(),this.select(n.children[(++e).clamp(0,n.children.length-1)])}},e.prototype.initialize=function(){return this.name=this.getAttribute("name"),this.addEventListener("DOMNodeRemoved",this._nodeRemoved),this.addEventListener("DOMNodeInserted",this._nodeAdded),this.addEventListener(UI.Events.action,this._select),this.addEventListener("blur",this._blur),this.addEventListener("focus",this._focus),this.addEventListener("keydown",this._keydown),this.selectDefault()},e.prototype.selectDefault=function(){var t;return t=this.querySelector(UI.Option.SELECTOR()+"[selected]:not([disposed])"),null==t&&(t=this.querySelectorAll(UI.Option.SELECTOR()+":not([disposed])")[0]),this.select(t)},e.prototype.select=function(t){var e,n,r,i;return e=t instanceof HTMLElement?t:this.querySelector(UI.Option.SELECTOR()+("[value='"+t+"']"))||null,this.selectedOption!==e?e?(null!=(r=this.selectedOption)&&(r.selected=!1),e.selected=!0,null!=(i=this.label)&&(i.textContent=this.selectedOption.textContent),this.fireEvent("change")):(null!=(n=this.label)&&(n.textContent=""),this.selectedOption&&(this.selectedOption.selected=!1),this.fireEvent("change"),void 0):void 0},e}(UI.Abstract);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Slider=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="slider",e.prototype._setValue=function(t){return e.__super__._setValue.apply(this,arguments),this.style.backgroundSize=""+100*t+"% 100%"},e}(UI.Range);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Textarea=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.validators=UI.Text.prototype.validators,e.TAGNAME="textarea",e}(UI.iInput);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Toggle=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="toggle",e.MARKUP=[UI.promiseElement("div",{},["ON"]),UI.promiseElement("div"),UI.promiseElement("div",{},["OFF"])],e.prototype._keydown=function(t){if(-1!==[37,38,39,40].indexOf(t.keyCode))switch(t.keyCode){case 37:case 38:return this.checked=!1;case 39:case 40:return this.checked=!0}},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.addEventListener("keydown",this._keydown)},e}(UI.iCheckable);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.Tooltip=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="tooltip",e.get("label",function(){return this.textContent}),e.set("label",function(t){return this.textContent=t}),e.prototype._enter=function(t){return this.parentNode.hasAttribute("disabled")||this.disabled||getParent(t.target,UI.Tooltip.SELECTOR())?void 0:this.open()},e.prototype._leave=function(){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:this.close()},e.prototype._toggle=function(){return this.parentNode.hasAttribute("disabled")||this.disabled?void 0:this.toggle()},e.prototype.onAdded=function(){var t=this;return e.__super__.onAdded.apply(this,arguments),this.parentNode.addEventListener(UI.Events.enter,this._enter.bind(this)),this.parentNode.addEventListener(UI.Events.leave,this._leave.bind(this)),this.parentNode.addEventListener("keydown",function(e){return e.altKey?t._toggle():void 0})},e.prototype.initialize=function(){return e.__super__.initialize.call(this,["top","bottom","left","right"])},e}(UI.iOpenable);var _ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};UI.View=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype._addEvents=function(){var t,e,n,r,i,o;r=this.events,o=[];for(n in r)t=r[n],n.match(/\s/)?(i=n.split(/\s/),n=i[0],e=i[1],UI.Events[n]&&(n=UI.Events[n]),o.push(this.delegateEventListener(n,e,this[t].bind(this)))):(UI.Events[n]&&(n=UI.Events[n]),o.push(this.addEventListener(n,this[t].bind(this))));return o},e.prototype.initialize=function(){return this._addEvents()},e}(UI.Abstract),UI.initialize();var Item,_ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Item=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="item",e.MARKUP=[{checkbox:UI.Checkbox.promise()},UI.promiseElement("i",{"class":"icon-sign-blank"}),{label:UI.Label.promise()},{number:UI.Label.promise()},UI.promiseElement("i",{"class":"icon-remove"})],e.get("category",function(){return this.getAttribute("category")||null}),e.set("category",function(t){return t?this.setAttribute("category",t):this.removeAttribute("category")}),e.get("quantity",function(){return parseFloat(this.number.textContent)}),e.set("quantity",function(t){return this.number.textContent=t}),e.set("name",function(t){return this.label.textContent=t}),e.get("name",function(){return this.label.textContent}),e.get("done",function(){return this.checkbox.checked}),e.set("done",function(t){return this.checkbox.checked=!!t,this.toggleAttribute("done",!!t)}),e.prototype.events={"action i.icon-remove":"remove","change ui-checkbox":"change"},e.prototype.remove=function(){return this.ref.set(null)},e.prototype.change=function(){return this.ref.child("done").set(this.done)},e.prototype.init=function(t){return this.ref=t,this.ref.on("value",this.update.bind(this))},e.prototype.update=function(t){var e;return(e=t.val())?(this.name=e.name,this.quantity=e.quantity,this.category=e.category,this.done=e.done,e):void 0},e}(UI.View);var List,_ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};List=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="list",e.MARKUP=[UI.promiseElement("div",{},[UI.Button.promise({name:"logout",type:"info"},[UI.promiseElement("i",{"class":"icon-signout"})]),{select:UI.Select.promise({})},UI.Button.promise({name:"add",type:"danger"},[UI.promiseElement("i",{"class":"icon-plus"})]),UI.Button.promise({name:"filter",type:"warning"},[UI.promiseElement("i",{"class":"icon-filter"})])]),{body:UI.promiseElement("div",{"class":"body"})}],e.prototype.events={"action [name=filter]":"toggleFilter","action [name=add]":"add","action [name=logout]":"logout","change ui-select":"filterCategory"},e.get("filter",function(){return this.hasAttribute("filtered")}),e.set("filter",function(t){return this.querySelector("[name=filter]").toggleAttribute("toggled",!!t),this.toggleAttribute("filtered",!!t)}),e.prototype.add=function(){return this.fireEvent("navigate",{page:"add"})},e.prototype.logout=function(){return this.fireEvent("logout",{page:"login"})},e.prototype.toggleFilter=function(){return this.filter=!this.filter},e.prototype.filterCategory=function(){return this.select.value?this.setAttribute("category",this.select.value):this.removeAttribute("category")},e.prototype.initialize=function(){var t,n,r;e.__super__.initialize.apply(this,arguments),this.select.label.textContent="All",this.added=this.added.bind(this),this.removed=this.removed.bind(this),this.select.dropdown.appendChild(UI.Option.promise({value:""},["All"])()),r=[];for(t in CATEGORIES)n=CATEGORIES[t],r.push(this.select.dropdown.appendChild(UI.Option.promise({value:t},[n.label])()));return r},e.prototype.empty=function(){var t,e;return this.body.innerHTML="",null!=(t=this.ref)&&t.off("child_added",this.added),null!=(e=this.ref)?e.off("child_removed",this.added):void 0},e.prototype.added=function(t){var e,n;return e=t.val(),n=Item.promise({id:t.name()})(),n.init(t.ref()),this.body.appendChild(n)},e.prototype.removed=function(t){return this.body.removeChild(this.body.querySelector("[id='"+t.name()+"']")),this.fireEvent("notify",{message:"Item removed...",_type:"info"})},e.prototype.init=function(t){return this.ref=t,this.ref.on("child_added",this.added),this.ref.on("child_removed",this.removed)},e}(UI.View);var Login,_ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Login=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="login",e.MARKUP=[{form:UI.Form.promise({},[{email:UI.Email.promise({name:"email",required:"true",placeholder:"Email"})},{password:UI.promiseElement("input",{type:"password",required:"true",name:"password",placeholder:"Password"})},UI.Button.promise({type:"info"},[UI.promiseElement("div",{},[UI.promiseElement("i",{"class":"icon-spin icon-spinner"})]),UI.promiseElement("span",{},["Login"])]),UI.Button.promise({type:"danger"},[UI.promiseElement("div",{},[UI.promiseElement("i",{"class":"icon-spin icon-spinner"})]),UI.promiseElement("span",{},["Register"])])])}],e.prototype.events={validate:"validate","action ui-button[type=info]":"login","action ui-button[type=danger]":"register"},e.set("loading",function(t){var e,n,r,i,o,s,a,u;if(t){for(this.querySelector("ui-button[type="+t+"]").setAttribute("loading",!0),s=this.querySelectorAll("ui-button"),u=[],n=0,i=s.length;i>n;n++)e=s[n],u.push(e.disabled=!0);return u}for(a=this.querySelectorAll("ui-button"),r=0,o=a.length;o>r;r++)e=a[r],e.removeAttribute("loading");return this.validate()}),e.prototype.validate=function(){var t,e,n,r,i;for(r=this.querySelectorAll("ui-button"),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.disabled=this.form.invalid);return i},e.prototype.start=function(){return this.auth=new FirebaseSimpleLogin(REF,this._authentication.bind(this))},e.prototype.logout=function(){return this.auth?this.auth.logout():void 0},e.prototype.register=function(){return this.form.validate()?(this.auth.createUser(this.email.value,this.password.value,this._authentication.bind(this)),this.loading="danger"):void 0},e.prototype.login=function(){return this.form.validate()?(this.auth.login("password",{email:this.email.value,password:this.password.value}),this.loading="info"):void 0},e.prototype.reset=function(){return this.email.value=this.password.value="",this.form.validate()},e.prototype._authentication=function(t,e){return document.body.setAttribute("ready","true"),this.loading=!1,t?this.fireEvent("notify",{message:t,_type:"danger"}):(this.reset(),e?this.fireEvent("authenticated",{user:e}):this.fireEvent("unathenticated"))},e}(UI.View);var Application,_ref,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Application=function(t){function e(){return _ref=e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.TAGNAME="application",e.MARKUP=[{notification:UI.Notification.promise({horizontal:"center",vertical:"bottom"})},{pager:UI.Pager.promise({},[UI.Page.promise({name:"main"},[{list:List.promise()}]),UI.Page.promise({name:"add"},[UI.Form.promise({},[{grid:UI.Grid.promise({columns:3})},{name:UI.Text.promise({placeholder:"What?"})},{quantity:UI.Number.promise({placeholder:"How many?"})},UI.Button.promise({type:"danger",action:"add"},["Add"]),UI.Button.promise({action:"back"},["Back"])])]),UI.Page.promise({name:"login",active:"true"},[UI.promiseElement("div",{"class":"center"},[UI.promiseElement("img",{src:"icon.png"}),UI.promiseElement("h1",{},["Shoppy"]),{login:Login.promise()}])])])}],e.prototype.events={navigate:"navigate",authenticated:"authenticated",unathenticated:"unathenticated",logout:"logout","action [action=add]":"add","action [action=back]":"main","action ui-cell":"select",notify:"notify"},e.prototype.main=function(){return this.pager.change("main")},e.prototype.logout=function(){return this.login.logout()},e.prototype.init=function(){return this.login.start()},e.prototype.notify=function(t){return this.notification.push(t.message,t._type)},e.prototype.select=function(t){var e,n,r,i;for(i=this.querySelectorAll(".selected"),n=0,r=i.length;r>n;n++)e=i[n],e.classList.remove("selected");return t.target.classList.add("selected")},e.prototype.add=function(){var t,e,n,r=this;if(this.name.value)return t=(null!=(n=this.querySelector(".selected"))?n.getAttribute("category"):void 0)||null,e={done:!1,name:this.name.value,category:t,quantity:this.quantity.value},REF.child(this.user.id).push(e,function(){return r.pager.change("main"),r.notification.push("Item added...","info")})},e.prototype.reset=function(){return this.list.select.value="",this.list.filter=!1,this.list.empty()},e.prototype.resetAdd=function(){var t;return this.quantity.value="",this.name.value="",null!=(t=this.querySelector(".selected"))?t.classList.remove("selected"):void 0},e.prototype.authenticated=function(t){return this.authedOnce=!0,this.pager.change("main"),this.list.init(REF.child((this.user=t.user).id))},e.prototype.unathenticated=function(){var t=this;return setTimeout(function(){return t.removeAttribute("loading"),t.reset()},this.authedOnce?700:0),this.pager.change("login")},e.prototype.initialize=function(){var t,n,r;e.__super__.initialize.apply(this,arguments),this.setAttribute("loading",!0),r=[];for(t in CATEGORIES)n=CATEGORIES[t],r.push(this.grid.appendChild(UI.Cell.promise({category:t},[UI.promiseElement("i",{"class":n.icon})])()));return r},e.prototype.navigate=function(t){return"add"===t.page&&this.resetAdd(),this.pager.change(t.page)},e}(UI.View),window.CATEGORIES={food:{icon:"icon-food",label:"Food"},drink:{icon:"icon-glass",label:"Drink"},gift:{icon:"icon-gift",label:"Gift"},electronics:{icon:"icon-desktop",label:"Electronics"},games:{icon:"icon-gamepad",label:"Games"},storage:{icon:"icon-archive",label:"Stuff"},favorite:{icon:"icon-heart",label:"Favorites"}},window.app=Application.promise()(),window.REF=new Firebase("https://spendi.firebaseio.com/"),UI.onBeforeLoad=function(){return document.body.appendChild(app)},UI.onLoad=function(){return REF.once("value",function(){return app.init()})};